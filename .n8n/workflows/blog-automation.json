{
  "name": "Blog Auto-Update Workflow",
  "nodes": [
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "github-webhook",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "1a5b2c3d-4e5f-6789-abc1-234567890def",
      "name": "GitHub Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 1,
      "position": [
        240,
        300
      ]
    },
    {
      "parameters": {
        "conditions": {
          "string": [
            {
              "value1": "={{$json[\"ref\"]}}",
              "operation": "equal",
              "value2": "refs/heads/main"
            }
          ]
        }
      },
      "id": "2b6c3d4e-5f60-789a-bcd2-345678901ef0",
      "name": "Check Main Branch",
      "type": "n8n-nodes-base.if",
      "typeVersion": 1,
      "position": [
        460,
        300
      ]
    },
    {
      "parameters": {
        "authentication": "accessToken",
        "resource": "repository",
        "operation": "get",
        "owner": "{{$json[\"repository\"][\"owner\"][\"login\"]}}",
        "repository": "{{$json[\"repository\"][\"name\"]}}"
      },
      "id": "3c7d4e5f-6071-89ab-cde3-456789012f01",
      "name": "Get Repository Info",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        680,
        200
      ],
      "credentials": {
        "githubApi": {
          "id": "github-token",
          "name": "GitHub API Token"
        }
      }
    },
    {
      "parameters": {
        "authentication": "accessToken",
        "resource": "file",
        "operation": "list",
        "owner": "{{$json[\"repository\"][\"owner\"][\"login\"]}}",
        "repository": "{{$json[\"repository\"][\"name\"]}}",
        "filePath": "_posts"
      },
      "id": "4d8e5f60-7182-9abc-def4-567890123012",
      "name": "List Posts",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        900,
        200
      ],
      "credentials": {
        "githubApi": {
          "id": "github-token",
          "name": "GitHub API Token"
        }
      }
    },
    {
      "parameters": {
        "authentication": "accessToken",
        "resource": "repository",
        "operation": "createDispatchEvent",
        "owner": "{{$json[\"repository\"][\"owner\"][\"login\"]}}",
        "repository": "{{$json[\"repository\"][\"name\"]}}",
        "eventType": "build-pages",
        "clientPayload": "={\"trigger\": \"n8n-automation\", \"timestamp\": \"{{new Date().toISOString()}}\", \"posts_count\": {{$json[\"tree\"].length}}}"
      },
      "id": "5e9f6071-8293-abcd-ef45-678901234123",
      "name": "Trigger Pages Build",
      "type": "n8n-nodes-base.github",
      "typeVersion": 1,
      "position": [
        1120,
        200
      ],
      "credentials": {
        "githubApi": {
          "id": "github-token",
          "name": "GitHub API Token"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\"status\": \"success\", \"message\": \"Blog automation triggered\", \"repository\": \"{{$json[\"repository\"][\"full_name\"]}}\", \"ref\": \"{{$json[\"ref\"]}}\", \"timestamp\": \"{{new Date().toISOString()}}\"}"
      },
      "id": "6f0a7182-9304-bcde-f567-789012345234",
      "name": "Success Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        1340,
        200
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\"status\": \"skipped\", \"message\": \"Not main branch, skipping automation\", \"ref\": \"{{$json[\"ref\"]}}\", \"timestamp\": \"{{new Date().toISOString()}}\"}"
      },
      "id": "70b8293-a415-cdef-6789-890123456345",
      "name": "Skip Response",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1,
      "position": [
        680,
        400
      ]
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://api.github.com/repos/{{$json[\"repository\"][\"owner\"][\"login\"]}}/{{$json[\"repository\"][\"name\"]}}/pages/builds",
        "authentication": "genericCredentialType",
        "genericAuthType": "httpHeaderAuth",
        "options": {
          "response": {
            "response": {
              "fullResponse": true
            }
          }
        }
      },
      "id": "81c939a-b526-def0-789a-901234567456",
      "name": "Manual Pages Build",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.1,
      "position": [
        1120,
        300
      ],
      "credentials": {
        "httpHeaderAuth": {
          "id": "github-header-auth",
          "name": "GitHub Header Auth"
        }
      }
    }
  ],
  "connections": {
    "GitHub Webhook": {
      "main": [
        [
          {
            "node": "Check Main Branch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Check Main Branch": {
      "main": [
        [
          {
            "node": "Get Repository Info",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Repository Info": {
      "main": [
        [
          {
            "node": "List Posts",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "List Posts": {
      "main": [
        [
          {
            "node": "Trigger Pages Build",
            "type": "main",
            "index": 0
          },
          {
            "node": "Manual Pages Build",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Trigger Pages Build": {
      "main": [
        [
          {
            "node": "Success Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {},
  "versionId": "1",
  "id": "blog-automation-workflow"
}